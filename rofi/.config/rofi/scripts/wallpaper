#!/bin/bash

export PATH="${PATH}:${HOME}/.local/bin/"

dir="$HOME/.config/rofi/launchers/type-1"
theme='style-1'

wallpapers=$HOME/Wallpapers
image="$(ls $wallpapers | rofi -dmenu -i -p "ï€¾  Select wallpaper: " -theme ${dir}/${theme}.rasi)"
wallpaper=$wallpapers/$image

if [[ -d $wallpapers/$image ]]; then
    echo "$wallpapers/$image is a directory"
    wallpaper_temp="$image"
    sleep2
    wallpaper_location="$(ls $wallpapers/$image | wofi -n --show dmenu -k "/dev/null")"
elif [[ -f $wallpapers/$image ]]; then
    echo "$wallpapers/$image is a file"
else
    echo "$wallpapers/$image is not valid"
    exit 1
fi

# swww img $wallpaper --transition-type grow --transition-fps 60 --transition-duration 1.0 --transition-bezier 0.65,0,0.35,1 --transition-step 255
feh --bg-fill $wallpaper

source ~/.colormode

wallight=""
gtktheme=Macchiato
gtktype=Dark

if [[ $isLight -eq 1 ]]; then
    wallight="-l"
    gtktheme=Latte
    gtktype=Light
fi

wal $wallight -i $wallpaper --cols16
# pywalfox update
pywal-discord -t default
wal-telegram --wal

. $HOME/.config/mako/update-colors.sh
. $HOME/.config/spicetify/Themes/Pywal/update-colors.sh &
. $HOME/.config/cava/scripts/update-colors.sh

echo "Net/ThemeName \"Catppuccin-$gtktheme-Standard-Blue-$gtktype\"" > $HOME/.xsettingsd
killall -HUP xsettingsd
xsettingsd &

kill -HUP $(pgrep -f 'bar.sh')
bash $HOME/.cache/wal/bar.sh & disown

killall -HUP dwm
